#!/bin/bash
# AGF避障导航 - 成功演示脚本
# 展示无人机成功绕过两个圆柱形障碍物

clear
echo "========================================================================"
echo "🚁 AGF避障导航演示 - 无人机通过圆柱形障碍物"
echo "========================================================================"
echo ""
echo "📍 障碍物配置:"
echo "   🔵 蓝色圆柱（左下）: (0.6, -0.5, 0.5) - 半径0.1m, 高1.0m"
echo "   🔴 红色圆柱（右上）: (-0.6, +0.5, 0.5) - 半径0.1m, 高1.0m"
echo "   📏 两柱间距: 1.0m"
echo ""
echo "🎯 导航任务:"
echo "   起点: (-1.0, 0.0, 0.5) 【左侧】"
echo "   终点: ( 1.0, 0.0, 0.5) 【右侧】"
echo "   直线距离: 2.0m"
echo ""
echo "🧠 控制架构:"
echo "   - APF规划器: 计算引力和斥力，生成避障航点"
echo "   - PPO模型: 精确执行底层飞行控制"
echo ""
echo "========================================================================"
echo ""
read -p "按回车开始演示..."
echo ""
echo "🚀 启动导航系统..."
echo ""

# 运行导航测试
conda run -n drones python test_agf_navigation.py \
    --start -1.0 0.0 0.5 \
    --target 1.0 0.0 0.5 \
    2>&1 | tee demo_success.log

# 提取关键结果
echo ""
echo "========================================================================"
echo "📊 导航结果统计"
echo "========================================================================"
grep -A10 "导航统计" demo_success.log | grep -v "^--"
echo ""

# 检查是否成功
if grep -q "✅ 是" demo_success.log; then
    echo "🎉 演示成功！无人机成功通过障碍物到达目标！"
    echo ""
    echo "✨ 关键成就:"
    echo "   ✅ 零碰撞警告"
    echo "   ✅ 平滑避障轨迹"  
    echo "   ✅ 精确到达目标"
    echo "   ✅ APF+PPO混合控制成功验证"
else
    echo "⚠️ 演示未完全成功，请检查日志: demo_success.log"
fi

echo ""
echo "========================================================================"
echo "📁 完整日志已保存到: demo_success.log"
echo "========================================================================"
